# Krait to Rust Translator üöÄ

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç—Ä–∞–Ω—Å–ª—è—Ç–æ—Ä —è–∑—ã–∫–∞ **Krait (BKM)** –≤ **Rust** –∫–æ–¥.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–¢—Ä–∞–Ω—Å–ª—è—Ç–æ—Ä –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã Krait (`.kr`, `.bkm`, `.bkt`) –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π Rust-–∫–æ–¥, –≥–æ—Ç–æ–≤—ã–π –∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ **actix-web** –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ Krait:

- **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**: `int`, `float`, `double`, `txt`, `bool`, `auto`
- **–§—É–Ω–∫—Ü–∏–∏**: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏ —Ç–∏–ø–∞–º–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞
  ```
  func add(int a, int b) -> int {
      return a + b;
  }
  ```

- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**: —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏–ª–∏ –±–µ–∑
  ```
  int x = 42;
  float pi = 3.14;
  txt name = "Alice";
  ```

- **–í—ã—Ä–∞–∂–µ–Ω–∏—è**: –±–∏–Ω–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π
  ```
  int result = a + b * c;
  bool is_equal = x == y;
  ```

- **–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã**: if/else
  ```
  if (n <= 1) {
      return 1;
  } else {
      return n * factorial(n - 1);
  }
  ```

- **Web —Ä–æ—É—Ç—ã**: HTTP –º–µ—Ç–æ–¥—ã (GET, POST, PUT, DELETE)
  ```
  @route "/api/users" GET {
      return json_encode();
  }
  ```

### –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–π Rust –∫–æ–¥:

- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è (i32, f32, f64, String, bool)
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ —Å —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º–∏ —Ç–∏–ø–æ–≤
- ‚úÖ Web routes —Å actix-web
- ‚úÖ JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å serde
- ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `main()` —Å HttpServer
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è `Cargo.toml` –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤

## üõ†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç—Ä–∞–Ω—Å–ª—è—Ç–æ—Ä–∞:

```
src/
‚îú‚îÄ‚îÄ lexer.rs      - –õ–µ–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (tokenization)
‚îú‚îÄ‚îÄ parser.rs     - –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ AST)
‚îú‚îÄ‚îÄ codegen.rs    - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Rust –∫–æ–¥–∞ –∏–∑ AST
‚îî‚îÄ‚îÄ main.rs       - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å CLI –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è
```

### –ü—Ä–æ—Ü–µ—Å—Å —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏:

1. **–õ–µ–∫—Å–µ—Ä** (lexer.rs): –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤
2. **–ü–∞—Ä—Å–µ—Ä** (parser.rs): —Å—Ç—Ä–æ–∏—Ç Abstract Syntax Tree (AST) –∏–∑ —Ç–æ–∫–µ–Ω–æ–≤
3. **–ö–æ–¥-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä** (codegen.rs): –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Rust –∫–æ–¥ –∏–∑ AST
4. **CLI** (main.rs): –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤ –∏ –ø—Ä–æ–µ–∫—Ç–æ–≤

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd /path/to/bkm
cargo build --release
```

### –¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

```bash
./target/release/bkm_translator input.kr output.rs
```

–ü—Ä–∏–º–µ—Ä:
```bash
./target/release/bkm_translator example.kr generated.rs
```

### –¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

```bash
./target/release/bkm_translator project /path/to/bkm/project /path/to/output
```

–°–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π Rust –ø—Ä–æ–µ–∫—Ç —Å:
- `Cargo.toml` —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ (actix-web, serde, sea-orm)
- `src/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π —Å–æ –≤—Å–µ–º–∏ –º–æ–¥—É–ª—è–º–∏
- –ì–æ—Ç–æ–≤—ã–º `main.rs` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

## üìö –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è

**Krait code** (example.kr):
```
func add(int a, int b) -> int {
    return a + b;
}
```

**Generated Rust**:
```rust
fn add(
    a: i32,
    b: i32
) -> i32 {
    return (a + b);
}
```

### –ü—Ä–∏–º–µ—Ä 2: –§—É–Ω–∫—Ü–∏—è —Å —É—Å–ª–æ–≤–∏—è–º–∏

**Krait code**:
```
func factorial(int n) -> int {
    if (n <= 1) {
        return 1;
    } else {
        return n * factorial(n - 1);
    }
}
```

**Generated Rust**:
```rust
fn factorial(
    n: i32
) -> i32 {
    if (n <= 1) {
        return 1;
    } else {
        return (n * factorial((n - 1)));
    }
}
```

### –ü—Ä–∏–º–µ—Ä 3: Web —Ä–æ—É—Ç—ã

**Krait code**:
```
@route "/api/greet" GET {
    txt message = "Hello, World!";
}
```

**Generated Rust** (–≤ main.rs):
```rust
#[actix_web::main]
async fn main() -> std::io::Result<()> {
    HttpServer::new(|| {
        App::new()
            .wrap(middleware::Logger::default())
            .route("/api/greet", web::get().to(get_api_greet))
    })
    .bind("127.0.0.1:8080")?
    .run()
    .await
}
```

## üîç –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –õ–µ–∫—Å–µ—Ä (Lexer)

- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 40+ —Ç–∏–ø–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ —Å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (`//`)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é (—Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–æ–ª–±—Ü—ã) –¥–ª—è –ª—É—á—à–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö

### –ü–∞—Ä—Å–µ—Ä (Parser)

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å–ø—É—Å–∫ (recursive descent parsing)
- –°—Ç—Ä–æ–∏—Ç —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π AST
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –æ–ø–µ—Ä–∞—Ü–∏–π
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏, —Ä–æ—É—Ç—ã –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

### –ö–æ–¥-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä (CodeGenerator)

- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–¥–∏–æ–º–∞—Ç–∏—á–Ω—ã–π Rust –∫–æ–¥
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è —Ç–∏–ø–æ–≤ Krait ‚Üí Rust
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Cargo.toml —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≤—ã–≤–æ–¥ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ—Ç—Å—Ç—É–ø–∞–º–∏

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–¢—Ä–∞–Ω—Å–ª—è—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- `regex` - –¥–ª—è –ª–µ–∫—Å–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- `serde` –∏ `serde_json` - –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- `anyhow` - –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- `thiserror` - –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç:
- `actix-web` - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- `tokio` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `sea-orm` - ORM –¥–ª—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
- `serde` - —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

## üöÄ –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- –õ–µ–∫—Å–∏—á–µ—Å–∫–∏–π –∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Rust —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –ë–∏–Ω–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
- –£—Å–ª–æ–≤–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (if/else)
- Web —Ä–æ—É—Ç—ã (—Å HTTP –º–µ—Ç–æ–¥–∞–º–∏)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å Cargo.toml
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞

### üîÆ –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

- [ ] –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ try/catch/raise –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- [ ] –¶–∏–∫–ª—ã (while, for)
- [ ] –ú–∞—Å—Å–∏–≤—ã –∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö —Å SeaORM
- [ ] –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ JSON
- [ ] –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –¥–ª—è –º–æ–¥—É–ª–µ–π
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ –∫–æ–¥–∞
- [ ] –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–æ—É—Ç–æ–≤
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

## üìù –ü—Ä–∏–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤

### test_simple.kr
```
func add(int a, int b) -> int {
    return a;
}
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä–æ—Å—Ç–∞—è Rust —Ñ—É–Ω–∫—Ü–∏—è

### example.kr
```
func add(int a, int b) -> int {
    return a + b;
}

func factorial(int n) -> int {
    if (n <= 1) {
        return 1;
    } else {
        return n * factorial(n - 1);
    }
}

func is_even(int x) -> bool {
    return (x % 2) == 0;
}

@route "/api/greet" GET {
    txt name = "World";
    txt greeting = "Hello, " + name;
    return greeting;
}

@route "/api/add" POST {
    int a = 5;
    int b = 3;
    int result = add(a, b);
    return result;
}
```

–ü–æ–ª–Ω–∞—è —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∏ web —Ä–æ—É—Ç–∞–º–∏

## üéì –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–∏–º–µ—Ä: –¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è `func add(int a, int b) -> int { return a + b; }`

1. **–õ–µ–∫—Å–µ—Ä**: –†–∞–∑–±–∏–≤–∞–µ—Ç –Ω–∞ —Ç–æ–∫–µ–Ω—ã
   ```
   Func, Identifier("add"), LeftParen, Int, Identifier("a"), ...
   ```

2. **–ü–∞—Ä—Å–µ—Ä**: –°—Ç—Ä–æ–∏—Ç AST
   ```
   FunctionDef {
       name: "add",
       params: [(a, Int), (b, Int)],
       return_type: Int,
       body: [Return(BinaryOp(Identifier("a"), "+", Identifier("b")))]
   }
   ```

3. **–ö–æ–¥-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä**: –í—ã–≤–æ–¥–∏—Ç Rust
   ```rust
   fn add(
       a: i32,
       b: i32
   ) -> i32 {
       return (a + b);
   }
   ```

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –∫–∞–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ DSL –≤ Rust.

---

**Krait ‚Üí Rust: –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è! üéØ**
